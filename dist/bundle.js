(()=>{"use strict";const e=e=>new Promise(((t,l)=>chrome.storage.sync.get(e,(e=>chrome.runtime.lastError?l(Error(chrome.runtime.lastError.message)):t(e)))));async function t(l){let o=await e("collect");o=JSON.stringify(o);let c="";if(!l.children)return c+=`<li class="bookmark-li" data-url="${l.url}" data-title="${l.title}">`,c+=`\n      <div class="bookmark-item">\n        <div class="bookmark-item-bg"></div>\n        <img class="iconTop" data-url="${l.url}" data-title="${l.title}" src="${-1===o.search(l.url)?"./img/collect2.svg":"./img/collected2.svg"}" />\n        <div class="bookmark-item-title">\n            <img src="https://www.google.com/s2/favicons?domain=${l.url}" alt="" />\n            <p class="ellipsis">${l.title}</p>\n          </div>\n          <p class="bookmark-item-url ellipsis">\n            ${l.url}\n          </p>\n          <div class="bookmark-info">\n            <p>${-1===o.search(l.url)?"未收藏":"已收藏"}</p>\n            <img class="icon ${-1===o.search(l.url)?"collect-icon":""}" data-url="${l.url}" data-title="${l.title}" src="${-1===o.search(l.url)?"./img/collect.svg":"./img/collected.svg"}" />\n          </div>\n        </div>\n      </li>`,c;if(c=`<div class="bookmark-folder">\n  <div class="bookmark-header">\n    <span class="btn-collapse btn-collapse--act"></span>\n    <h3 class="bookmark-title">${l.title}</h3>\n  </div>\n  <ul class="bookmark-ul" style="display:none">`,l.children.length)for(let e of l.children)e.children||(c+=await t(e));else c+='\n    <li class="no-data">\n      <img src="./img/empty.svg">\n      <p>暂无数据嗷，铁汁</p>\n    </li>';c+="</ul></div>";for(let e of l.children)e.children&&(c+=await t(e));return c}const l=async()=>{let t=await e("collect");t.collect?function(e){let t='<div class="bookmark-folder">\n  <div class="bookmark-header">\n    <span class="btn-collapse"></span>\n    <h3 class="bookmark-title">收藏夹</h3>\n  </div>\n  <ul class="bookmark-ul">';if(e.length>0)for(let l of e)t+=`\n      <li class="bookmark-li" data-url="${l.url}">\n        <div class="bookmark-item">\n          <div class="bookmark-item-bg"></div>\n          <img class="iconTop" src="./img/collected2.svg" />\n          \x3c!-- <img class="menu" src="./img/menu.svg" /> --\x3e\n          <div class="bookmark-item-title">\n            <img src="https://www.google.com/s2/favicons?domain=${l.url}" alt="" />\n            <p class="ellipsis">${l.title}</p>\n          </div>\n          <p class="bookmark-item-url ellipsis">\n            ${l.url}\n          </p>\n          <div class="bookmark-info">\n            <p>已收藏</p>\n            <img class="icon del-icon" data-url="${l.url}" src="./img/del.svg" />\n          </div>\n        </div>\n      </li>`;else t+='\n    <li class="no-data">\n      <img src="./img/empty.svg">\n      <p>暂无数据嗷，铁汁</p>\n    </li>';t+="</ul></div>",document.getElementById("collect").innerHTML=t}(t.collect):chrome.storage.sync.set({collect:[]})},o=()=>new Promise(((e,l)=>{chrome.runtime.sendMessage({},(async function(l){let o=JSON.parse(l),c=document.getElementById("bookmark");c.innerHTML="";let r=o[0].children;for(let e of r)c.innerHTML+=await t(e);document.body.appendChild(c),e()}))}));function c(e){const{url:t,title:c}=e.target.dataset;chrome.storage.sync.get("collect",(e=>{let r=JSON.parse(JSON.stringify(e.collect));r.push({url:t,title:c}),chrome.storage.sync.set({collect:r}),l(),o(),d()})),e.stopPropagation()}function r(e){const{url:t}=e.target.dataset;chrome.storage.sync.get("collect",(e=>{let c=JSON.parse(JSON.stringify(e.collect));c.forEach(((e,l)=>{e.url===t&&c.splice(l,1)})),chrome.storage.sync.set({collect:c}),l(),o()})),e.stopPropagation()}function s(e){let t=e.currentTarget.dataset.url;t&&window.open(t,"_blank")}function n(e){let t=e.currentTarget.parentNode.querySelector("ul");t.style.display="none"==t.style.display?"flex":"none",e.target.querySelector(".btn-collapse").classList.toggle("btn-collapse--act")}function a(e){let{value:t}=e.currentTarget.dataset;switch(t){case"light":i("light");break;case"dark":i("dark");break;case"auto":i("auto")}}function i(e){chrome.storage.sync.set({mode:e}),document.querySelector("body").setAttribute("color-mode",e)}const d=function(){Array.from(document.querySelectorAll(".bookmark-header")).forEach((e=>{e.addEventListener("click",n)})),Array.from(document.querySelectorAll(".bookmark-li")).forEach((e=>{e.addEventListener("click",s)})),Array.from(document.querySelectorAll(".collect-icon")).forEach((e=>{e.addEventListener("click",c)})),Array.from(document.querySelectorAll(".del-icon")).forEach((e=>{e.addEventListener("click",r)}))},m=function(){d(),document.querySelector("input").onkeypress=e=>{!function(e){if(13===e.which){var t=document.querySelectorAll(".search-select")[0],l=t.selectedIndex,o=t.options[l].value;const c=e.target.value;let r="";switch(o){case"baidu":r="https://baidu.com/s?wd=";break;case"google":r="https://www.google.com/search?q=";break;case"bing":r="https://www.bing.com/search?q=";break;case"sougou":r="https://www.sogou.com/web?query="}window.open(`${r}${c}`,"_blank")}}(e)},Array.from(document.querySelectorAll(".switch-tab")).forEach((e=>{e.addEventListener("click",a)})),document.querySelector(".form-item").addEventListener("click",(e=>{document.querySelector(".form-item").classList.toggle("mode-open")})),Array.from(document.querySelectorAll(".form-item svg")).forEach((e=>{e.addEventListener("click",a)}))};!async function(){await o(),await l(),m(),chrome.storage.sync.get("mode",(e=>{const{mode:t}=e;console.log(t),t||(chrome.storage.sync.set({mode:"auto"}),t="auto"),document.querySelector("body").setAttribute("color-mode",t)}))}()})();
//# sourceMappingURL=bundle.js.map